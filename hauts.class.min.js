// Hauts.Class
// 13.10.2015
// Hauts
// https://github.com/Hauts/Hauts.Class
!function(factory){function copy(s,e){for(var r in s)e[r]=s[r]}function testReserved(s){return s==SC||s==EX||s==IO||s==CN}function createName(){return CLASS_NAME_PREFIX+ ++CLASS_COUNTER}function createClassStructure(s){function e(s){s.superClass&&s.superClass!==DUMMY&&(r.push(s.superClass),e(s.superClass))}var r=[];return e(s),r.reverse(),r.push(s),r}factory.Hauts=factory.Hauts||new function(){};var Hauts=factory.Hauts,FN="function",UN="undefined",CN="className",EX="extend",IO="instanceOf",SC="superClass",OB="object",RT="return",ST="string",TH="this",CLASS_NAME_PREFIX="Class_",EMPTY={},DUMMY=Object,USE_DEEP_MODE=!0,USE_EVAL=!0,CLASS_COUNTER=0,INNER_INITIALIZATION=!1,Class=function(s,e,r,a,t){return Class.create(s,e,r,a,t)};Class.create=function(s,e,r,a,t){return Class.extend(null,s,e,r,a,t)},Class.useDeepMode=function(s){return typeof s!=UN&&(USE_DEEP_MODE=!!s),USE_DEEP_MODE},Class.extend=function(parentClass,className,classConstructor,classPrototype,staticProperties,useDeepMode){function createSuperClass(s,e,r){var a=!1,t=function(){if(!a){a=!0;var p=superClassInAction;superClassInAction=!0;var o=s.superClass;s.superClass=e.superClass.superClass,r.apply(s,arguments),s.superClass=o,p||(superClassInAction=!1)}return t};return t.className=r.className,t}function generateSuperClassProperty(s){function e(e,r){var a=function(){var a=superClassInAction;superClassInAction=!0;var t=s.superClass;s.superClass=r;var p=e.apply(s,arguments);return s.superClass=t,a||(superClassInAction=!1),p};return a.isInherited=e.isInherited,a}function r(s,r,a){for(var t in r)if(!testReserved(t)){var p=r[t];typeof p==FN&&(s[t]=e(p,a,t))}}for(var a=createClassStructure(s),t=1,p=a.length,o=[];p>t;t++)o.push(createSuperClass(s,a[t],a[t-1]));for(var t=1,c=o.length;c>t;t++){var n=o[t];n.superClass=o[t-1]}for(var t=c-1;t>=0;t--)r(o[t],a[t].prototype,o[t-1]);s.superClass=o[c-1]||new function(){},baseSuperClass=o[c-1]}function wrapInnerClassMethods(s){function e(s,e){if(s.isWrapper)return s;var r=function(){return superClassInAction&&(e.superClass=baseSuperClass),s.apply(e,arguments)};return r.isWrapper=!0,r.isInherited=s.isInherited,r}for(var r in s)if(!testReserved(r)){var a=s[r];typeof a==FN&&(s[r]=e(a,s))}}if(parentClass=typeof parentClass!=FN?DUMMY:parentClass,typeof className==FN?(staticProperties=classPrototype,classPrototype=classConstructor,classConstructor=className,className=createName()):typeof className==ST?typeof classConstructor!=FN&&(staticProperties=classPrototype,classPrototype=classConstructor,classConstructor=DUMMY):typeof className==OB?(staticProperties=classPrototype,classPrototype=className,classConstructor=DUMMY,className=createName()):typeof className==UN&&(className=createName()),typeof classConstructor==UN)classConstructor=DUMMY;else if(typeof classConstructor!=FN)throw new Error("classConstructor must be a Function");classPrototype=typeof classPrototype==UN?EMPTY:classPrototype,staticProperties=typeof staticProperties==UN?EMPTY:staticProperties;var parentClassPrototype=parentClass.prototype,superClassInAction=!1,baseSuperClass,classWrapper=function(){return INNER_INITIALIZATION?void 0:(generateSuperClassProperty(this),wrapInnerClassMethods(this),classConstructor.apply(this,arguments),wrapInnerClassMethods(this),this)};if(USE_EVAL){var classWrapperCodeArray=classWrapper.toString().split(FN),classWrapperCode=classWrapperCodeArray.shift()+FN+" "+className+classWrapperCodeArray.join(FN);classWrapperCode="("+FN+"(){"+RT+" "+classWrapperCode+"})()";try{classWrapper=eval(classWrapperCode)}catch(e){console.error("Could not eval class constructor function with source code: \n"+classWrapperCode)}}if(useDeepMode=typeof useDeepMode==UN?USE_DEEP_MODE:!!useDeepMode,USE_DEEP_MODE&&useDeepMode?(INNER_INITIALIZATION=!0,classWrapper.prototype=new parentClass,INNER_INITIALIZATION=!1):copy(parentClassPrototype,classWrapper.prototype),copy(classPrototype,classWrapper.prototype),parentClass!=DUMMY)for(var i in classWrapper.prototype)if(!testReserved(i)){var prop=classWrapper.prototype[i];typeof prop==FN&&typeof classPrototype[i]==UN&&(classWrapper.prototype[i]=eval("("+FN+"(){"+RT+" "+FN+"(){"+RT+" "+TH+"."+SC+"."+i+".apply("+TH+",arguments);}})()"),classWrapper.prototype[i].isInherited=!0)}if(copy(staticProperties,classWrapper),classWrapper.superClass=classWrapper.prototype.superClass=parentClass,classWrapper.className=classWrapper.prototype.className=className,classWrapper.extend=classWrapper.prototype.extend=function(s,e,r,a,t){return Class.extend(classWrapper,s,e,r,a,t)},classWrapper.instanceOf=classWrapper.prototype.instanceOf=function(s){if(classWrapper===s)return!0;if(classWrapper.superClass){if(classWrapper.superClass===s)return!0;if(typeof classWrapper.superClass.instanceOf==FN)return classWrapper.superClass.instanceOf(s)}return!1},Object.defineProperty){Object.defineProperty(classWrapper,SC,{writable:!1,value:parentClass});var classNameProps={writable:!1,value:className};Object.defineProperty(classWrapper,CN,classNameProps),Object.defineProperty(classWrapper.prototype,CN,classNameProps);var extendProps={writable:!1,value:classWrapper.extend};Object.defineProperty(classWrapper,EX,extendProps),Object.defineProperty(classWrapper.prototype,EX,extendProps);var instanceOfProps={writable:!1,value:classWrapper.instanceOf};Object.defineProperty(classWrapper,IO,instanceOfProps),Object.defineProperty(classWrapper.prototype,IO,instanceOfProps)}return classWrapper},Hauts.Class=Class}(this);